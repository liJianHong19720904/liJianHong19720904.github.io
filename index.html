<!doctype html>
<html lang="en">
 <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>
    读好书和写代码，或许是可以让你快乐的2件事————李健宏！
  </title>
   <style type="text/css">
    body{
	    margin: 0;
	    font-size:20px;}
	
	
   	div#stage{
	 position: relative;
	 border:3px solid;
	 height:460px;
	 background-color: rgb(38, 10, 2);
	 overflow: hidden;
	}
	 
	div#stage img{
	 display: block;
	 position: absolute;
	 left: 0;
	 top: 0;
	 opacity: 0.2;
	}
	div#stage p{
	 text-indent: 1em ;
	 color:rgb(239, 239, 246);
	 margin:0.5em ;
	 text-align: justify;
	}
	div#control span,div#control input{
	 display:inline-block ;
	 border:1px solid navy;
	 border-radius:10%;
	 background-color:rgb(20,10,0);
	 color:white ;
	 font-size：1.2em ;
	 padding:10px 15px;
	 margin:0.1em 0.2em ;
	 cursor:pointer;
	}
    
   div#control input{
    font-size :1.3em ;
	padding:5px 10px;
	width : 3em;
    background-color:black;
    color:white;
	text-align: center;
    }
	div#control span:hover{
	 background-color:rgb(90,20,0);
	 color:white;
	}
	div#control span:active{
	 background-color:rgb(80,160,160);
	 color:white;
	}
	div#control span a{
		color:rgb(200,250,0);
		text-decoration: none;
	}
    header,footer{
     font-size:1.3em;
	 background-color:black;
     color:white;
	 text-align: center;
	}
	footer{
     font-size:1em;
	 background-color:rgb(50, 50, 50);
     color:white;
	 text-align: center;
	}
   </style>
   <script type="text/javascript">
    <!--
    "use strict";
	 var mediaObj = { 
 		          currentTime : 0 ,
				  duration : 0 ,
				  canPlay : false  ,
		          id : 1 ,
		          audio: new Audio() ,
				  path: "https://lijianhong19720904.github.io/images/mp3/pride and prejudice " ,
				  clipNum : 61 , //上面URL共有61章《傲慢与偏见》朗读音频
                  waitInfos : [ '当按pause暂停音频时，我这些略显啰嗦的学习指导，就会像流水一样，随机出现，希望能有\"润物细无声\"的效果。','本页默认读取《傲慢与偏见》原著第一章音频，用Next和Prev按钮可以切换到原著全部61章的音频，点击play则可播放。','学好真正的功夫在诗外，掌握计算机科学不是记忆一堆知识，而是拥有计算和抽象思维，同时具备编码的能力，因此年轻人在本学科真正成长，大概率发生在课外的阅读原著和编写代码之时。','阅读经典原著很重要，比如我推荐当代大学生阅读和同时收听《傲慢与偏见》原著。Just Do It！英文真有障碍的学生，就只在第一章反复也会收益良多。' , ' 若看到本页时，你感觉网络访问很慢，那就太好了，你终于有时间静下心来为学好计算机科学，做一点理性的思考。但我可以骄傲的告诉你，只要能打开本页面，不管我们之间的网速有多慢，我的程序都可以流畅播放我想让你知道的所有信息！' , '计算机科学有大量英文经典原著，静静地在那，等着你准备好，拿起来阅读，修炼英文是基本功力，本站推荐的《傲慢与偏见》原文音频与原文阅读结合，是英语修习，也是一种精神享受。', '本页内链接了二门课程、几本电子书、一些音频文件，都存放在在著名的gitHub上。感谢伟大互联网上的这些优质的服务，当然更重要是它们对学习者免费。','连接本站的国内ChinaNet用户注意，打开课程和下载电子图书时，肯定比全球其他用户慢多了，但这也是小事，其实学习计算机科学的我们，现在需要慢下来，因为慢中思考才更有效。' ,'这里的《傲慢与偏见》原著音频是女声英文原声朗读，质量绝佳！','每次音频切换，意味着大量音频数据需要从gitHub传来，我们等待时也可以利用这点碎片时间，顺便看看我对学习计算机科学学习指导。','为了搜索能匹配《傲慢与偏见》经典原著的音频，我耗费了时间，收听了许多一般的朗读水平的音频，而能收集由如此语言功力女士演绎朗读的，这61章音频，也算机缘巧合，因此特别推荐。','首页有一个pAndP链接，链接了Webster出版的原著的文本PDF版，其中对比原著的词汇，列出大量学术研究需要的英文词汇，是SAT和GRE考试的好资源。若您需要，可以下载，文件7MB，即使速度很慢也值得下载！','当您播放音频，整个背景画面会有循环动画，配合音频播放，而当音频下载的数据不够播放时，画面会卡住，需要您再等等。','当按pause暂停音频时，我这些啰嗦的婆婆妈妈的学习指导，会像流水一样随机说出，希望能有点\"润物细无声\"的效果。','Everything that happens to a child of god is Fathter filtered , and he intends to use it for good , even when others mean it for bad .','真正的《计算机科学》的学习，不是记忆一堆知识，而是在用代码表达对计算机各种概念的理解，表达自己的想法和实现设计！','写代码是学好计算机科学的最好的手段，同时也可以训练思维，锻炼能力。','本站的WebBas是以Web平台为背景的程序设计的入门系列课程，初学者可以用来入门，普通人建议安排在1年左右学完。','本站的WebAdv是以Web平台为背景的，程序设计的进阶系列课程，学习需要有点程序基础，非计算机专业的朋友一般需要安排1年左右的时间来学习。','WebCMD是探索JavaScript语言的小神器，由我特别为初学程序设计的朋友而贴心地设计开发，弥补了移动端没有键盘和命令行互动的遗憾，在手机上的人机互动体验还不错！','CSSBook内链接了一本非常平易近人（英文起点低），原版的计算机语言书，推荐大家作为CSS语言入门学习阅读。','WordPower内链接了一本非常好的的英文原版书，大学生若需要提升英文词汇量，这本书也值得看几年，推荐下载使用。','下面白色按钮，用来控制《傲慢与偏见》音频播放，而绿色按钮，则是我为当代大学生“特别”定制，用于计算机科学导论学习教学资源。' ,'若下载的电子书的格式若为epub，则表面这个电子书是为移动端阅读特制的，一般移动端设备的电子书APP可以打开阅读，国内的Android手机平台推荐使用“掌阅”APP打开！','学习计算机科学，可以阅读的很多英文原版原著，从计算机语言到操作系统，充分理解，反复重构写出的代码，才是好的代码。若有幸到了这个境界，阅读和编码将是非常快乐的事。'],
                  
                 getAudioById : () => {
                     let id = mediaObj.id ;
                     let audio = mediaObj.audio ;
                     let path = mediaObj.path ;
                     let pathId = '' ;
                     
                     //console.log('"this" is ' + this) ;

                     if (id < 10){
						  pathId = '0' + id ;
					    } else{
						  pathId = id ;
					     }
                     if (audio.currentTime > 0){
                        audio.pause();
					  }
				      audio.src = path +  pathId + ".mp3" ;
                   }, //End of  getAudioById
                  clock : null ,
                  slowerCounter: 0 , //这是一个计数器，让2s运行一次的时钟，发生3次倒数才执行字幕输出，避免字幕输出太快！
              clockCode : () => {
                        let audio = mediaObj.audio ;
                        let background = mediaObj.background ;
                        let waitInfos = mediaObj.waitInfos ;
                        let UI = mediaObj.UI ;
						
					    if (mediaObj.canPlay  && !audio.paused){
                            mediaObj.currentTime = parseInt(audio.currentTime) ;
							mediaObj.duration = parseInt(audio.duration) ;
							let percent = Math.floor( mediaObj.currentTime / mediaObj.duration * 100 );
                            UI.Percent.value = percent ;

                            if(background.clock){
                                  //说明动画已经调用，不可再用setInterval启动另外一个异步代码
                             }else{
                                    background.clock = setInterval(background.moveBackground , 50);
                                }
					       } else { // mediaObj.canPlay 为 false 或 audio.paused
                                if(!mediaObj.canPlay){
									audio.pause();
			                  	   //停止本例的背景动画代码放置在此处
                                    clearInterval(background.clock)  ;
								    background.clock = null ;
								  }								
								  mediaObj.slowerCounter ++ ;
								  //console.log(mediaObj.slowerCounter) ;
								  if(mediaObj.slowerCounter >= 5 ){
									let s = waitInfos[Math.floor(waitInfos.length * Math.random())] ;
									UI.addInfoToStage('您知道吗？' + s) ;
									mediaObj.slowerCounter = 0
								}
							   }
					     } , //End of clockCode
				  background : {
					           num : 19 , //本例选择新图片组，定义从网络读取的图片数量
							   path: "https://lijianhong19720904.github.io/WebAdv/images/pAndP/" ,//本例读取的图片的URL，文件名从1.jpg到19.jpg
							   imgDoms : [] ,
							   onLoadNum : 0 , 
							   getImgTime : [] , //这个属性，以数组形式记录19个图片读取成功的时间，未来可以用来分析图片在网络读取状况。
  
                               getBackground : () => {
                                let audio = mediaObj.audio ;
                                let background = mediaObj.background ;
                                let UI = mediaObj.UI ;
				            	 for (let i=1; i<= background.num ; i++){
                                    background.imgDoms[i-1] = new Image() ;
                                    background.imgDoms[i-1].src = background.path + i +".jpg" ;
									background.imgDoms[i-1].addEventListener('load',()=> {
									 background.onLoadNum ++ ;
									 background.getImgTime.push(new Date());
									 UI.addInfoToStage("成功读取" + background.onLoadNum + "张剧照！");
								  },false)
						         }
				                }, //End of getBackground
							   clock : null , //控制背景动画的clock
  
                  setBackground : () => {
                       let background = mediaObj.background ;
                       let UI = mediaObj.UI ;
						if(background.onLoadNum < background.num / 5 ) { //读取了三分之一图片数即可，全部读取对于第一次本程序的运行，等待的时间可能过久，即使有反馈，用户或许也难以等待19张全部读取成功。
                            //UI.addInfoToStage("正在读取电影剧照...") ;
							//2秒后再次设置调用本方法，若19张图片没有读取成功，则本方法会一直用2秒的频率执行
							setTimeout(background.setBackground,2000) ;
						}else{ //异步读取成功，并以现在读取的图片为准，设置排列为“胶卷形式”
                             let parent = UI.Stage ; 
		                     let xPos = 0 ;
							 let imgDoms = background.imgDoms ;
		                      for (let i=0; i< imgDoms.length ; i++ ) {
		                        let img = imgDoms[i] ;
								let ratio = img.width / img.height ;
			                         img.height = 460 ; //配合CSS样式对stage舞台的高度
			                         img.width = 460 * ratio ;
			                         img.style.left = xPos + 'px' ;
			                         xPos += img.width ;
		                             parent.appendChild(img);	
								 }           
	                           };//end of  else this.onLoadNum < this.num
	                         },//End of setBackground 
 
                  moveBackground : () => {
		                   let parent = mediaObj.UI.Stage ; 
		                   let imgs = mediaObj.background.imgDoms ;
                 // 上面改动说明：以前使用 querySelectorAll('img') 方式，临时从页面获取图像DOM节点的方式，显然在高频执行动画代码中，效率偏低。直接从内存中（mediaObj.background.imgDoms）获取对象的reference引用，代码速度会高很多;
		                       let widthImgs = 0 ;
		                       for(let i=0 ;i<imgs.length;i++){
			                    widthImgs += imgs[i].width ;
		                         }
		                       for (let i=0; i< imgs.length ; i++ ) {
			                    let xPos = parseInt(imgs[i].style.left) ;
			                    if(xPos >= - imgs[i].width){
			                      imgs[i].style.left = (xPos - 1) + 'px' ;
			                     }else{
			                       imgs[i].style.left = widthImgs - imgs[i].width + 'px' ;
			                     }
		                       }//End for loop    
	                  } , //End of moveBackground
		           } //End of background Object
			 } ; //End of  mediaObj definition

	window.addEventListener("load",init,false);
	
	function init(){

   		mediaObj.UI = {
	         Play : document.querySelector("div span#play") ,
	         Pause : document.querySelector("div span#pause") ,
	         Percent : document.querySelector("div input#percent"),
			 Prev  : document.querySelector("div span#prev") ,
             Next  : document.querySelector("div span#next") ,
			 AddVol : document.querySelector("div span#addVol")  ,
             SubVol : document.querySelector("div span#subVol")  ,
			 Stage: document.querySelector("div#stage"),
			 clockOfInfo: null ,
			 pTxtDom : null ,
			 infoOfStage: '' ,
			  infoAnimation: ()=>{
				let s = mediaObj.UI.infoOfStage.substring(0,1) ;
				//console.log(s) ;

				let pDom =  mediaObj.UI.pTxtDom ;
				let clock = mediaObj.UI.clockOfInfo ;
                pDom.textContent += s ;
				mediaObj.UI.infoOfStage  =  mediaObj.UI.infoOfStage.substring(1);
				if (mediaObj.UI.infoOfStage.trim() ===''){
				 clearInterval(mediaObj.UI.clockOfInfo); 
				 mediaObj.UI.clockOfInfo = null ;
				}
			 },
			 addInfoToStage: function(info){
			 //在页面的Stage区域，实现了infoNum条文本信息逐条显示
				 const infoNum = 3 ;
				 var stageDom = document.querySelectorAll("p") ;
				 if (stageDom.length === infoNum){
					mediaObj.UI.Stage.removeChild(stageDom[0]) ;
				 }
				  
				  var pDom = document.createElement("p") ;
				      
					  mediaObj.UI.infoOfStage = info ;   
					  mediaObj.UI.infoOfPDom = pDom ;
					  
					  mediaObj.UI.Stage.appendChild(pDom) ;
                      mediaObj.UI.pTxtDom = pDom ;
					  if(mediaObj.UI.clockOfInfo === null){
						mediaObj.UI.clockOfInfo = setInterval(mediaObj.UI.infoAnimation , 50) ;
					  }

				 } //end of addInfoToStage
				 

      };//End of mediaObj.UI

      
      mediaObj.getAudioById();
	  mediaObj.background.getBackground();
      mediaObj.background.setBackground();
	  
   
       //下面代码都是对UI控件的行为设计
	 
	mediaObj.UI.Play.addEventListener("click",function(){
	      mediaObj.audio.play() ;
		  var s =  "Chapter " + mediaObj. id + " 音频，在 " + mediaObj.currentTime + " 秒，开始播放！"  ;
		  mediaObj.UI.addInfoToStage(s) ;
        /****下面是复制过来的动态改变播放进度值的代码****/
		 clearInterval(mediaObj.clock);
		 mediaObj.clock = setInterval(mediaObj.clockCode,2000);
      /****上面是复制过来的动态改变播放进度值的代码****/
	   },false);

	mediaObj.UI.Pause.addEventListener("click",function(){
	      mediaObj.audio.pause() ;
		  var s =  "Chapter " + mediaObj. id + " 播放暂停在："+ mediaObj.currentTime + " 秒。" + " 音频总长度：" + mediaObj.duration  + " 秒。" ;
          mediaObj.UI.addInfoToStage(s) ;
			
		},false); // 音频暂停按钮

    mediaObj.UI.Percent.addEventListener("click",function(){
	  
	   window.clearInterval(mediaObj.clock);

       mediaObj.audio.pause();
	   var s = "请谨慎填入进度值。" + "当前进度：" + Math.floor(mediaObj.currentTime/mediaObj.duration*100) + "% 。" ;
	   mediaObj.UI.addInfoToStage('Chapter ' + mediaObj.id +' . ' + s) ;
	  },false);

    mediaObj.UI.Percent.addEventListener("blur",function(){
	  var playTime = parseInt(mediaObj.UI.Percent.value) / 100 * mediaObj.audio.duration  ;
	  if (!playTime ){
         playTime = 0 ;
	  }
      mediaObj.audio.currentTime = playTime ;
	  mediaObj.audio.play();
	  var s = "即将跳转到"+ Math.floor(mediaObj.audio.currentTime) + " 秒！" ;
	  mediaObj.UI.addInfoToStage('Chapter ' + mediaObj.id +' . '+ s) ;
     /****下面是复制过来的动态改变播放进度值的代码****/
	     clearInterval(mediaObj.clock);
		 mediaObj.clock = setInterval(mediaObj.clockCode , 2000);
    /****上面是复制过来的动态改变播放进度值的代码****/
	 mediaObj.canPlay = false ;
	  },false);

     
      mediaObj.UI.SubVol.addEventListener("click",function(){
		  var s = "音量调整为：" ;
		  if (mediaObj.audio.volume > 0){
			  mediaObj.audio.volume -= 0.1 ;
		  }
		   s += parseInt(mediaObj.audio.volume * 100) + "%" ;
		   mediaObj.UI.addInfoToStage(s) ;
		  },false);

      mediaObj.UI.AddVol.addEventListener("click",function(){
		  var s = "音量调整为：" ;
		  if (mediaObj.audio.volume < 1){
			  mediaObj.audio.volume += 0.1 ;
		  }
		   s += parseInt(mediaObj.audio.volume * 100) + "%" ;
		   mediaObj.UI.addInfoToStage('Chapter ' + mediaObj.id +' . ' + s) ;
		  },false);

    
     mediaObj.UI.Prev.addEventListener("click",function(){
	  if (mediaObj.id===1){
		  mediaObj.id =  mediaObj.clipNum ;
	  }else{
	     mediaObj.id -- ;
	  }
	  mediaObj.getAudioById();
      var s =  "开始加载音频文件： " + "Chapter " + mediaObj.id  ;
	  mediaObj.UI.addInfoToStage(s)  ;
	  mediaObj.UI.addInfoToStage("若是第一次，请耐心等待……");

	  mediaObj.canPlay = false ;

    /****下面是复制过来的动态改变播放进度值的代码****/
	     clearInterval(mediaObj.clock);
		 mediaObj.clock = setInterval(mediaObj.clockCode , 2000);
    /****上面是复制过来的动态改变播放进度值的代码****/

	 },false);//end of mediaObjPrev.click

     mediaObj.UI.Next.addEventListener("click",function(){
	   if (mediaObj.id === mediaObj.clipNum ){
		  mediaObj.id = 1 
	    }else{
	      mediaObj.id ++ ;
	   }
      mediaObj.getAudioById();
	  var s =   "开始加载音频文件： " + "Chapter " + mediaObj.id  ;
	  mediaObj.UI.addInfoToStage(s) ;
      mediaObj.UI.addInfoToStage("若您是第一次听，请耐心等待……");

      
	  mediaObj.canPlay = false ;
	  /****下面是复制过来的动态改变播放进度值的代码****/
	     clearInterval(mediaObj.clock);
		 mediaObj.clock = setInterval(mediaObj.clockCode , 2000);
     /****上面是复制过来的动态改变播放进度值的代码****/
	 },false);//end of mediaObjNext.click
   
   //下面二个事件处理函数，利用了HTML5标准的Web音频、视频最重要的二个API事件，即loadedmetadata 和canplaythrough ，有兴趣发掘更多细节则请参考HTML5音视频编程的技术文档。
    mediaObj.audio.addEventListener("loadedmetadata",function(){
	   var s = 'Chapter ' + mediaObj.id +' . '+ "成功载入该音频的元数据。";
       mediaObj.UI.addInfoToStage(s) ;
	       s = 'Chapter ' + mediaObj.id +' . '+"本音频文件共: " + Math.floor(mediaObj.audio.duration) + "秒 。";
       mediaObj.UI.addInfoToStage(s) ;
      },false);
   
      mediaObj.audio.addEventListener("canplaythrough",function(){
        var s = "Ok，音频文件可以正常播放了！";
       mediaObj.UI.addInfoToStage('Chapter ' + mediaObj.id +' . ' + s) ;
	   mediaObj.canPlay = true ;
	     },false);

      /**本例新增代码，用于2s更新一次播放音频的进度值**/
	  /*下面时钟代码*/
      mediaObj.clock = setInterval(mediaObj.clockCode , 2000);

	}//init 函数定义结束 
  //-->
  </script>
 </head>
 <body>
  <header>
	《大学生学计算机科学导论》之实践篇--编码和阅读
  </header>
  <div id="stage">
	
  </div>
  <div id="control">
  播放进度：<input id="percent" type="text" value="0">% 
	 <span id="play">Play</span> 
	 <span id="pause">Pause</span>
     <span id="prev">Prev</span>
	 <span id="next">Next</span>
	 <span id="addVol">+Vol+</span>
	 <span id="subVol">-Vol-</span>
	 <span ><a href="images/cssBasic.epub">CSSBook</a></span>
	 <span ><a href="images/Word Power Made Easy.epub">WordPower</a></span>
	 <span ><a href="images/pAndPWebster.pdf">pAndP</a></span>
	 <span ><a href="qrcode.png">二维码</a></span>
	 <span ><a href="WebBasic/images/exOfWeb.html">WebCMD</a></span>
	 <span ><a href="WebBasic/index.html">WebBas</a></span>
	 	 <span ><a href="WebAdv/index.html">WebAdv</a></span>
  </div>
  <footer>‘读好书，编好程’——江西科技师范大学李健宏2022</footer> 
 </body>
</html>
